"use strict";!function(){window.qs=function(e,n){return(n||document).querySelector(e)},window.$on=function(e,n,t,a){e.addEventListener(n,t,!!a)},window.$parent=function(e,n){return e.parentNode?e.parentNode.tagName.toLowerCase()===n.toLowerCase()?e.parentNode:window.$parent(e.parentNode,n):void 0},window.$createImgSource=function(e){return"https://farm"+e.farm+".staticflickr.com/"+e.server+"/"+e.id+"_"+e.secret+".jpg"},window.$addClass=function(e,n){e.classList?e.classList.add(n):e.className+=" ${className}"},window.$removeClass=function(e,n){e.classList?e.classList.remove(n):e.className=e.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," ")},window.$renderOverlay=function(e){var n=window.qs(".lightbox-image");n.setAttribute("src",e)},window.$debounce=function(e,n){var t=null;return function(){var a=this,i=arguments;clearTimeout(t),t=setTimeout(function(){e.apply(a,i)},n)}},window.$GET=function(e,n){var t=new XMLHttpRequest;t.open("GET",e,!0),t.onload=function(){if(t.status>=200&&t.status<400){var e=JSON.parse(t.responseText);n(e)}},t.onerror=function(e){console.err(e)},t.send()}}(window);var Grid=function(){var e=function(e,n){window.$GET("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=851eba61830c7c59ab64308b75eec2f7&tags="+e+"%2C+film&sort=relevance&per_page=9&page=1&format=json&nojsoncallback=1",n)},n=function(e){return e.map(function(e){return e.src=window.$createImgSource(e),e})},t=function(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.textContent=""},a=function(e){t(window.qs("main")),e.forEach(function(e){var n=document.createElement("div");n.className="grid-image-container";var t=document.createElement("div");t.className="grid-image",t.style.backgroundImage="url("+e.src+")",n.appendChild(t),n.setAttribute("data-image-id",e.id),window.$on(n,"click",function(e){var n=e.target?e.target:e.srcElement;n.dispatchEvent(window.$stateEvent("openModal")),window.$addClass(window.qs(".overlay"),"is-open")}),window.qs("main").appendChild(n)});var n=document.createElement("div");n.className="grid-film-description";var a="Kodak Ektar is often considered one of the world's finest grain\n    color negative film. Photographs shot with Ektar often have little noise due\n    to its low ISO speed (100). The colors are ultra-vivid, shots are exceptionally\n    sharp, and the film is ideal for modern-day scanning. It's use cases are\n    typically with nature and travel photography.";n.innerHTML=a,window.qs("main").appendChild(n)};return{fetchImages:e,mapImages:n,removeImages:t,renderImages:a}},Emulsion=function(){var e={modalOpen:!1,images:null,lightbox:null,currFilmType:"ektar",currFilmIndex:"0",availFilmTypes:["ektar","portra","tri-x","superia","velvia"]},n=window.Grid(),t=function(n,t,a){e[n]=t,void 0!==a&&a(t)},a=function(n){return void 0===n?e:e[n]},i=function(){n.fetchImages(e.currFilmType,function(a){t("images",n.mapImages(a.photos.photo),function(){n.renderImages(e.images)})})},o=function(){window.qs("#current-film").innerHTML=e.currFilmType},r=function(){var a=null,r=0;void 0!==e.availFilmTypes[e.currFilmIndex+1]?(a=e.availFilmTypes[e.currFilmIndex+1],r=e.currFilmIndex+1):a=e.availFilmTypes[r],t("currFilmType",a),t("currFilmIndex",r,function(){i(),n.renderImages(e.images),o()})},s=function(e,n){var i=a("images").reduce(function(n,t,a){return t.id===e?a:null!==n?n:void 0},null);switch(n){case"prevImage":t("lightbox",a("lightbox")-1);break;case"nextImage":t("lightbox",a("lightbox")+1);break;case"openModal":t("lightbox",i);break;case"closeModal":t("lightbox",null)}a("lightbox")+1===a("images").length?window.$addClass(window.qs(".overlay-right"),"is-disabled"):0===a("lightbox")?window.$addClass(window.qs(".overlay-left"),"is-disabled"):(window.$removeClass(window.qs(".overlay-right"),"is-disabled"),window.$removeClass(window.qs(".overlay-left"),"is-disabled"))};o(),i();var l=window.qs(".app-container");return window.$on(l,"stateChange",function(e){switch(e.detail.action){case"nextImage":s(null,"nextImage"),window.$renderOverlay(a("images")[a("lightbox")].src);break;case"prevImage":s(null,"prevImage"),window.$renderOverlay(a("images")[a("lightbox")].src);break;case"closeModal":t("modalOpen",!1),t("lightbox",null);break;case"openModal":var n=e.target?e.target:e.srcElement,i=n.parentElement.attributes["data-image-id"].value;t("modalOpen",!0),s(i,"openModal"),window.$renderOverlay(a("images").find(function(e){return e.id===i}).src)}console.log("Action Type: "+e.detail.action),console.log(a())}),{getState:a,nextFilmType:r}}(),init=function(){var e=window.Emulsion;window.$on(window.qs("#next-film-arrow"),"click",e.nextFilmType);var n=window.qs(".overlay"),t=window.qs(".modal-close-btn");window.$on(t,"click",function(e){var t=e.target?e.target:e.srcElement;t.dispatchEvent(window.$stateEvent("closeModal")),window.$removeClass(n,"is-open")});var a=window.qs(".overlay-right");window.$on(a,"click",function(e){var n=e.target?e.target:e.srcElement;n.dispatchEvent(window.$stateEvent("nextImage"))});var i=window.qs(".overlay-left");window.$on(i,"click",function(e){var n=e.target?e.target:e.srcElement;n.dispatchEvent(window.$stateEvent("prevImage"))}),window.$stateEvent=function(n,t){return new CustomEvent("stateChange",{detail:{action:n,callback:t,state:e.getState(),time:new Date},bubbles:!0,cancelable:!0})}}();